function googleTagManager() {
    // Google Tag Manager encompasses script, inline script and no script
    // var googleTagManagerUrl = 'https://www.googletagmanager.com/gtm.js?id=GTM-KHWBXW5';
    var googleTagManagerSelector = 'script[src*="googletagmanager"]';
    var googleTagManagerInlineScript = "(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n" +
                                         "    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n" +
                                         "    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n" +
                                         "    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n" +
                                         "    })(window,document,'script','dataLayer','GTM-MB6M6FT');";
    var googleTagManagerNoScript = '<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MB6M6FT height="0" width="0" style="display:none;visibility:hidden"></iframe>';
    var headEl = document.querySelector('head');
    var bodyEl = document.querySelector('body');
    var headerEl = document.querySelector('header');
  
    function loadScript() {
      // googletagmanager script tag is generared by googletagmanager inline script
      // var script = document.createElement('script');
      // script.setAttribute('src', googleTagManagerUrl);
      // script.setAttribute('async', '');
      // headEl.appendChild(script);
      // googletagmanager inline script
      var inlineScript = document.createElement('script');
      inlineScript.textContent = googleTagManagerInlineScript;
      //headEl.appendChild(inlineScript);
      bodyEl.insertBefore(inlineScript, headerEl);
      // googletagmanager no script
      var noScript = document.createElement('noscript');
      noScript.textContent = googleTagManagerNoScript;
      bodyEl.insertBefore(noScript, headerEl);
    }
  
    function deleteScript() {
      var googleTagManagerScriptEl = headEl.querySelectorAll(googleTagManagerSelector);
      var scriptEl = bodyEl.querySelectorAll('script');
      var noScriptEl = bodyEl.querySelectorAll('noscript');
  
      // delete googletagmanager script tag
      Array.prototype.forEach.call(googleTagManagerScriptEl, function(el) {
        headEl.removeChild(el);
      });
      // delete googletagmanager inline script
      Array.prototype.forEach.call(scriptEl, function(el) {
        if (el.textContent.indexOf('googletagmanager') !== -1) {
          bodyEl.removeChild(el);
        }
      });
      // delete googletagmanager no script
      Array.prototype.forEach.call(noScriptEl, function(el) {
        if (el.textContent.indexOf('googletagmanager') !== -1) {
          bodyEl.removeChild(el);
        }
      });
    }
  
    function bindCookieCategory(category) {
      if (typeof window.CookieSettingsManager === 'object') {
  
  
  
        if (window.CookieSettingsManager.getStatusForCategory(category)) {
  
          loadScript();
  
        } else {
  
          deleteScript();
        }
  
        document.addEventListener('onCookieSettingsChanged', function(event) {
          if (event.detail.cookieSettings[category].approved) {
            /**
             * do something if category is approved while runtime
             */
            loadScript();
  
          } else {
            /**
             * do something if category is rejected while runtime
             */
            deleteScript();
  
          }
        });
      }
      else {
         // Fallback if Cookie-Settings-Manager is not initialized
      }
    }
  
    bindCookieCategory('stats');
  }
  googleTagManager();